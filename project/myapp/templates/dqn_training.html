<!--

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>DQN 訓練</title>
    {% load static %}
    <script>
        // 每 5 秒更新 Reward 圖（加上時間戳避免快取）
        function refreshImage() {
            var img = document.getElementById("rewardImg");
            img.src = "{% static 'images/dqn_reward.png' %}?" + new Date().getTime();
        }
        setInterval(refreshImage, 5000);
    </script>
</head>
<body>
    <h1>DQN 訓練</h1>
    <form method="POST" action="{% url 'dqn_training' %}">
        {% csrf_token %}
        {% for i in "01234" %}
        <fieldset>
            <legend>商品 {{ forloop.counter0 }}</legend>
            買進價格下限: <input type="text" name="buy_low_{{ forloop.counter0 }}" required><br>
            買進價格上限: <input type="text" name="buy_high_{{ forloop.counter0 }}" required><br>
            賣出價格下限: <input type="text" name="sell_low_{{ forloop.counter0 }}" required><br>
            賣出價格上限: <input type="text" name="sell_high_{{ forloop.counter0 }}" required><br>
        </fieldset>
        <br>
        {% endfor %}
        <input type="submit" value="開始訓練">
    </form>
    {% if result %}
    <p>{{ result }}</p>
    {% endif %}
    <h2>Reward 圖</h2>
    <img id="rewardImg" src="{% static 'images/dqn_reward.png' %}" alt="Reward Graph" width="600">
</body>
</html>
 -->
 <!DOCTYPE html>
 <html>
 <head>
     <meta charset="utf-8">
     <title>DQN 訓練</title>
     {% load static %}
     <script>
         // 當使用者按下「生成欄位」時，根據商品數量動態建立欄位
         function generateFields() {
             var productCount = document.getElementById("productCount").value;
             var container = document.getElementById("fieldsContainer");
             container.innerHTML = "";  // 清空原有內容
             for (var i = 0; i < productCount; i++) {
                 var fieldset = document.createElement("fieldset");
                 var legend = document.createElement("legend");
                 legend.innerHTML = "商品 " + i;
                 fieldset.appendChild(legend);
                 fieldset.innerHTML += '買進價格下限: <input type="text" name="buy_low_' + i + '" required><br>';
                 fieldset.innerHTML += '買進價格上限: <input type="text" name="buy_high_' + i + '" required><br>';
                 fieldset.innerHTML += '賣出價格下限: <input type="text" name="sell_low_' + i + '" required><br>';
                 fieldset.innerHTML += '賣出價格上限: <input type="text" name="sell_high_' + i + '" required><br>';
                 container.appendChild(fieldset);
                 container.innerHTML += "<br>";
             }
             // 同步更新隱藏欄位的商品數量
             document.getElementById("hiddenProductCount").value = productCount;
         }
 
         // Reward 圖自動刷新（加上時間戳避免快取）
         function refreshImage() {
             var img = document.getElementById("rewardImg");
             img.src = "{% static 'images/dqn_reward.png' %}?" + new Date().getTime();
         }
         setInterval(refreshImage, 1000);
     </script>
 </head>
 <body>
     <h1>DQN 訓練</h1>
     <!-- 第一部分：輸入商品數量 -->
     <form id="countForm" method="GET" action="">
         <label>請輸入商品數量：</label>
         <input type="number" id="productCount" name="product_count" value="5" min="1" required>
         <button type="button" onclick="generateFields()">生成欄位</button>
     </form>
     <hr>
     <!-- 第二部分：輸入各商品價格區間 -->
     <form method="POST" action="{% url 'dqn_training' %}">
         {% csrf_token %}
         <!-- 隱藏欄位存放商品數量 -->
         <input type="hidden" name="product_count" id="hiddenProductCount" value="5">
         <div id="fieldsContainer">
             {% for i in "01234" %}
             <fieldset>
                 <legend>商品 {{ forloop.counter0 }}</legend>
                 買進價格下限: <input type="text" name="buy_low_{{ forloop.counter0 }}" required><br>
                 買進價格上限: <input type="text" name="buy_high_{{ forloop.counter0 }}" required><br>
                 賣出價格下限: <input type="text" name="sell_low_{{ forloop.counter0 }}" required><br>
                 賣出價格上限: <input type="text" name="sell_high_{{ forloop.counter0 }}" required><br>
             </fieldset>
             <br>
             {% endfor %}
         </div>
         <input type="submit" value="開始訓練">
     </form>
     {% if result %}
         <p>{{ result }}</p>
     {% endif %}
     <h2>Reward 圖</h2>
     <img id="rewardImg" src="{% static 'images/dqn_reward.png' %}" alt="Reward Graph" width="600">
 </body>
 </html>


